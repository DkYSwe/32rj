<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wisdom Loader</title>
    <script>
        // AGGRESSIVE PRE-RENDER KILLER
        const urlParams = new URLSearchParams(window.location.search);
        const gui = (urlParams.get('gui') || 'no').toLowerCase();
        
        // If help is requested, just redirect immediately
        if (urlParams.has('help')) {
            const SCRIPT_URL = "YOUR_NEW_DEPLOY_URL_HERE";
            window.location.replace(`${SCRIPT_URL}?${urlParams.toString()}`);
        }
        
        // If gui=no, redirect immediately to Google's raw text service
        if (gui === 'no') {
            const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyP9WYlCEs0-QyPJ0zdEUDEdlRT3meGiTfmPl_kTwxBFzlecz1eZOuxBJxKyIe9h08akg/exec";
            window.location.replace(`${SCRIPT_URL}?${urlParams.toString()}`);
        }
    </script>
</head>
<body style="margin:0; font-family:sans-serif;">
    <div id="app" style="text-align:center; padding:50px;">Loading wisdom...</div>

    <script>
        // This part only runs if gui=yes
        async function fetchQuote() {
            const SCRIPT_URL = "YOUR_NEW_DEPLOY_URL_HERE";
            const params = new URLSearchParams(window.location.search);
            params.set('t', Date.now()); // Aggressive cache busting

            try {
                const res = await fetch(`${SCRIPT_URL}?${params.toString()}`, { redirect: 'follow' });
                const data = await res.json();
                
                if (params.get('colors') === 'yes') document.body.style.backgroundColor = "#f5f5ed";
                
                let content = `<div style="font-size:1.8rem;">${data.quote.replace(/([,.;!?])\s*/g, '$1<br>')}</div>`;
                if (data.author && params.get('author') !== 'no') {
                    content += `<hr style="margin:20px auto; width:30%; opacity:0.2;"><div style="font-style:italic;">â€” ${data.author}</div>`;
                }
                document.getElementById('app').innerHTML = content;
            } catch (err) {
                document.getElementById('app').innerText = "Connection Error.";
            }
        }
        if (gui === 'yes') fetchQuote();
    </script>
</body>
</html>
